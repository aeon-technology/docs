<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DFF</title>
    <style>*,*:before,*:after{box-sizing:border-box}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;color:#333}nav a:where(.active){background:#333;color:#fff}img{display:block;max-width:100%}code{font-weight:600}pre{background:#444;color:#fff;padding:1ch}pre code{background-color:inherit}table{border-collapse:collapse}table :where(th,td){border:1px solid #666}:where(h2,h3,h4) a{color:inherit;text-decoration:none}:where(h2,h3,h4) a:hover{text-decoration:underline}:where(h2,h3,h4) a:hover:after{content:" #"}.c-app-layout{display:grid;margin:0 auto;grid-template-columns:auto 1fr;gap:32px}.c-app-menu{top:0;position:sticky;overflow-y:scroll;padding:0 32px;background-color:#eee;height:100vh}
</style>
  </head>
  <body class="c-app-layout">
    <aside class="c-app-menu">
      <nav class="u-reset"><p>User Guide DFF 8.0</p>
<ul>
<li><a href="../index.html">Introduction</a></li>
</ul>
<p>Online Use</p>
<ul>
<li><a href="../online/registration.html">Registration</a></li>
<li><a href="../online/tutorial.html">Tutorial</a></li>
<li><a href="../online/support.html">Support</a></li>
</ul>
<p>Offline Use</p>
<ul>
<li><a href="../offline/get-started.html">Get Started</a></li>
<li><a href="../offline/tutorialA.html">Tutorials A - Essential Functionality</a>
<ul>
<li><a href="../offline/tutorialsA-builder.html">Tutorial A1 - Building a Model of Molecule</a></li>
<li><a href="../offline/tutorialsA-liquid.html">Tutorial A2 - Working With a Liquid Model</a></li>
<li><a href="../offline/tutorialsA-polymer.html">Tutorial A3 - Working with Polymers</a></li>
<li><a href="../offline/tutorialsA-protein.html">Tutorial A4 - Working with Proteins</a></li>
<li><a href="../offline/tutorialsA-mixforcefields.html">Tutorial A5 - Mixing Force fields</a></li>
</ul>
</li>
<li><a href="../offline/tutorialB.html">Tutorials B - Parameterization Methods</a>
<ul>
<li><a href="../offline/tutorialsB-qmdata.html">Tutorial B1 - Prepare QM Data</a></li>
<li><a href="../offline/tutorialsB-fitmolecule.html">Tutorial B2 - Fit QM Data of Molecule</a></li>
<li><a href="../offline/tutorialsB-fitdimer.html">Tutorial B3 - Fit QM Data of Molecular Dimer</a></li>
<li><a href="../offline/tutorialsB-fitliquid.html">Tutorial B4 - Fit Liquid Data</a></li>
</ul>
</li>
<li><a href="../offline/tutorialC.html">Tutorials C - Database Methods</a>
<ul>
<li><a href="../offline/tutorialsB-qmdata.html">Tutorial C1 - Augment TEAMFF</a></li>
<li><a href="../offline/tutorialsB-qmdata.html">Tutorial C2 - Use QMDFF</a></li>
</ul>
</li>
</ul>
<p>Concepts, Methods and Algorithms</p>
<ul>
<li>
<p><a href="forcefield-types.html">Force Field Types</a></p>
<ul>
<li><a href="forcefield-types.html">AMBER Type</a></li>
<li><a href="forcefield-types.html">TEAM Type</a></li>
</ul>
</li>
<li>
<p><a href="atom-types.html">Atom Types</a></p>
<ul>
<li><a href="atom-types-properties.html">Molecular and Atomic Properties</a></li>
<li><a href="atom-types-typingrules.html">Typing Rules</a></li>
<li><a href="atom-types-extensible.html">Extensible Definitions</a></li>
<li><a href="atom-types-hypervalence.html">Hyper-valence</a></li>
<li><a href="atom-types-equivalence.html">Equivalent Types</a></li>
<li><a href="atom-types-integrated.html">Integrated Types</a></li>
</ul>
</li>
<li>
<p><a href="parametrization.html">Parametrization</a></p>
<ul>
<li><a href="parametrization-trainingset.html">Training Set</a></li>
<li><a href="parametrization-general.html">General Procedure</a></li>
<li><a href="parametrization-autoPar.html">Automatic Parameters</a></li>
<li><a href="parametrization-qmd.html">Quantum Mechanics Data </a></li>
<li><a href="parametrization-fitqmd.html">Fit Quantum Mechanics Data </a></li>
<li><a href="parametrization-fitdimer.html">Fit Molecular Dimer</a></li>
<li><a href="parametrization-fitliquid.html">Fit Liquid Data</a></li>
</ul>
</li>
<li>
<p><a href="teamff-database.html">TEAMFF Database</a></p>
<ul>
<li><a href="teamff-forcefields.html">Included Force Fields</a></li>
<li><a href="teamff-extensibility.html">Extensibility of TEAMFF</a></li>
</ul>
</li>
<li>
<p><a href="qmdff-database.html">QMDFF Database</a></p>
</li>
<li>
<p><a href="molecular-simulations.html">Molecular Simulations</a></p>
</li>
</ul>
<p>References of GUI Commands</p>
<ul>
<li><a href="../gui-commands/overview.html">Manage Projects</a>
<ul>
<li><a href="../gui-commands/project-tree.html">Project Tree</a></li>
<li><a href="../gui-commands/toolbar-commnads.html">Toolbar Commands</a></li>
<li><a href="../gui-commands/mouse-function.html">Mouse Functions</a></li>
</ul>
</li>
<li><a href="../gui-commands/file-menu.html">File Menu</a></li>
<li><a href="../gui-commands/build-menu.html">Build Menu</a></li>
<li><a href="../gui-commands/view-menu.html">View Menu</a></li>
<li><a href="../gui-commands/teamff-menu.html">TEAMFF Menu</a></li>
<li><a href="../gui-commands/simulation-menu.html">Simulation Menu</a></li>
<li><a href="../gui-commands/qmdff-menu.html">QMDFF Menu</a></li>
<li><a href="../gui-commands/qmdff-menu.html">Force Field Menu</a></li>
<li><a href="../gui-commands/parameter-menu.html">Parameter Menu</a></li>
<li><a href="../gui-commands/qmd-menu.html">QMD Menu</a></li>
<li><a href="../gui-commands/help-menu.html">Help Menu</a></li>
</ul>
<p>References of Executable Commands</p>
<ul>
<li><a href="../exe-commands/model-com.html">Model Commands</a></li>
<li><a href="../exe-commands/forcefield-com.html">ForceField Commands</a></li>
<li><a href="../exe-commands/export-com.html">Export Commands</a></li>
<li><a href="../exe-commands/database-com.html">TEAMFF Commands</a></li>
<li><a href="../exe-commands/fit-com.html">Fit Commands</a></li>
<li><a href="../exe-commands/mm-com.html">Molecular Mechanics Commands</a></li>
<li><a href="../exe-commands/qm-com.html">Quantum Mechanics Commands</a></li>
<li><a href="../exe-commands/qmdff-com.html">QMDFF commands</a></li>
</ul>
<p>Appendix</p>
<ul>
<li><a href="../appendix/functions.html">Force Field Functions</a></li>
<li><a href="../exe-commands/firl-formats.html">File Formats</a></li>
</ul>
<p>Temporary Examples</p>
<ul>
<li><a href="../ch00/01-basic-syntax.html">Basic syntax</a></li>
<li><a href="../ch00/02-footnote.html">Footnote</a></li>
<li><a href="../ch00/03-table.html">Table</a></li>
<li><a href="../ch00/04-math-expression.html">Math expression</a></li>
</ul></nav>
    </aside>
    <main id="main"><article><h2 id="quantum-mechanics-data"><a href="#quantum-mechanics-data">Quantum Mechanics Data</a></h2>
<p>The importance of preparing quality quantum mechanics data (QMD) cannot be overstated. Generally speaking, if the fit itself is successful - which can be verified by checking the fit merits (squares of displacements, variances of parameters) - the quality of resulting forcefield is mostly determined by the quality of the underlying data. It is therefore very important to provide complete, quality data in order to develop a successful forcefield.</p>
<p>SAMPLING CONFORMATIONAL ENERGY SPACE</p>
<p>To derive forcefield parameters for a molecule using QM method, at least one optimized structure must be provided, and the calculations should include total energy, gradients, the Hessian matrix (the second derivatives of energy), and atomic charges.
Different structures of a molecule in addition to the minimum energy structure can be included to sample potential energy surfaces. In most cases, the interested structures are conformational isomers, which can be generated by rotating bonds measured by dihedral angles. Although structures generated by distorting bond lengths and angles could also be included, it is not necessary in forcefield development because the anharmonic behavior is not significant under conditions of classic simulations. Many forcefield types do not support the anharmonic terms. Even for forcefield type such as CFF that includes the anharmonic terms, those terms can be well estimated from the harmonic term (see TEAM type). Therefore, the distortion sampling usually does not include bond lengths and angles.
The conformers can be calculated by rigid or relaxed samplings. In rigid sampling the correlations among different internal coordinates are ignored, the dihedral angles are changed while all other internal coordinates are fixed to their equilibrium values. In relaxed sampling, the correlations are taken into consideration, for a set of dihedral angles specified, all other internal coordinates are relaxed. Although more computational resources are required in the relaxed sampling, the obtained potential energies are near minimum energy states, the forcefield parameters obtained by fitting the potential energies are more reliable.</p>
<p>To sample the conformational space efficiently is not trivial for a molecule with multiple rotatable bonds. A systematical scan of entire surface quickly becomes unmanageable. For example, for a molecule with 3 rotatable bonds, if each rotation needs to calculate 10 points in corresponding dihedral angle, a total of 1000 minimizations are required. One may use the random sampling to pick up certain number of points and then find the local minima by energy minimization. Another approach, called orthogonal sampling, may find not only the minimal energy points, but also the saddle points. In the orthogonal sampling, the rotatable bonds are scanned one after another, not simultaneously, from identified minimum energy points. Although the conformational space is not completely sampled, the data points will likely cover the important lower energy regions. As illustrated by the following figure of a 2-D energy surface. Starting from a minimum energy point M0, varying φ1 reaches minimum energy point M1 and varying φ2 reaches another minimum energy point M’1 (solid lines). Moreover, varying either φ1 from M’1 or φ2 from M1 both reaches M2 (dash lines). By doing so, the local minima and vicinity of saddle points are scanned, but not the high-energy region (H).</p>
<p>SAMPLING INTERMOLECUALR ENERGY CURVE
The QM method can be used to probe intermolecular interactions by calculating structures and energies of molecular dimers. DFF supports this type of calculation and provides a method to generate dimer structures automatically. However, it must be noted that using QM methods to characterize weak VDW interactions is a challenging task. Even if calculations can be performed accurately with high levels of correlation and a complete basis set, results still represent interactions between two molecules in a vacuum. To get accurate van der Waals parameters for molecules in condensed phases, condensed phase properties must be used to optimize the forcefield.
QMD FILE</p>
<p>QM calculations can be done by using any quantum mechanics software package. In order to support different software packages, a standardized file format was designed for storage of QM data. This file format is the QMD file format (more details in Chapter 6) and uses the extension *.qmd. QMD files are written in simple text file format, and is the only interface between QM calculations and DFF software. DFF can also convert output files generated by Gaussian to QMD files.</p>
<p>Each QMD file corresponds to one molecule, must contain one optimized structure, and may or may not contain conformational isomers. The optimized structure, contains essential data: energy, first and second derivatives of energy, atomic charges (Mulliken or ESP), and electrostatic multiple moments. Conformational isomers, if included, do not require second derivatives. Calculation protocols, methods and basis sets are embedded in the QMD file. The QMD file also contains molecular topology information (connectivity, formal charges, atom types, etc.) which are not required for input, but are generated and used by DFF for parameterization.</p>
<p>There are no particular requirements on the QM methods (HF, DFT, MP2, etc.) and the basis sets used in calculations. Since the ultimate criterion is agreement with experimental data, any QM method that can produce good agreement with experimental data can be used to generate QMD. The DFT method with B3LYP functionality and a modest 6-31G(d) basis set is adequate for describing structural and energetic properties of most organic molecules,48 and is used as the default QM calculation protocol in DFF.
Before QMD data is used for parameterization, it is a good practice to check data validity. Usually this can be done by comparing relative energies of different structural isomers in a QMD file. The lowest relative energy should correspond to the global minimum with a Hessian matrix calculated. Relative energies should not be too large, and charge parameters should be present in the data set.</p></article></main>
    <script type="module">"use strict";console.log("ui ready");[...document.querySelectorAll("nav a")].find(a=>a.pathname===location.pathname)?.classList.add("active");
</script>
  </body>
</html>
