<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DFF</title>
    <style>*,*:before,*:after{box-sizing:border-box}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;color:#333}nav a:where(.active){background:#333;color:#fff}img{display:block;max-width:100%}code{font-weight:600}pre{background:#444;color:#fff;padding:1ch}pre code{background-color:inherit}table{border-collapse:collapse}table :where(th,td){border:1px solid #666}:where(h2,h3,h4) a{color:inherit;text-decoration:none}:where(h2,h3,h4) a:hover{text-decoration:underline}:where(h2,h3,h4) a:hover:after{content:" #"}.c-app-layout{display:grid;margin:0 auto;grid-template-columns:auto 1fr;gap:32px}.c-app-menu{top:0;position:sticky;overflow-y:scroll;padding:0 32px;background-color:#eee;height:100vh}
</style>
  </head>
  <body class="c-app-layout">
    <aside class="c-app-menu">
      <nav class="u-reset"><p>I. Introduction</p>
<ul>
<li><a href="../index.html">Overview</a></li>
<li><a href="../features.html">Feature List</a></li>
<li><a href="../usecases.html">Typical Use Cases</a></li>
</ul>
<p>II. How To</p>
<ul>
<li><a href="../HowTo/Install.html">Download and installation</a></li>
<li><a href="../HowTo/License.html">Get license</a></li>
<li><a href="../HowTo/Navigate.html">Navigate DFF</a></li>
<li><a href="../HowTo/BuildModel.html">Build a model</a></li>
<li>Import models</li>
<li>Assign TEAMFF</li>
<li>Export models</li>
<li>Build a training set</li>
<li>Get quantum mechanics data</li>
<li>Fit quantum mechanics data</li>
<li>Fit Liquid data</li>
<li>Test force fields</li>
<li>Export to simulation software</li>
<li>Expand TEAMFF</li>
<li>Check out parameters from TEAMFF</li>
<li>Make new force field in TEAMFF</li>
<li>Make specific force field</li>
<li>Use Parametrization Workflow</li>
</ul>
<p>III. Tutorials</p>
<ul>
<li>[Overview] (./offline/tutorials.md)</li>
<li><a href="../offline/tutorials-project/lecture.html">Project and Models</a></li>
<li><a href="../offline/tutorials-liquid.html">Use TEAMFF for Liquids</a></li>
<li><a href="../offline/tutorials-polymer.html">Use TEAMFF for Macromolecules</a></li>
<li><a href="../offline/tutorials-mixforcefields.html">Use Multiple Force Fields of TEAMFF</a></li>
<li><a href="../offline/tutorialsB-qmdata.html">Prepare QM Data for Parameterization</a></li>
<li><a href="../offline/tutorialsB-fitmolecule.html">Fit QM Data of Molecules</a></li>
<li><a href="../offline/tutorialsB-fitliquid.html">Optimize LJ parameters</a></li>
<li><a href="../offline/tutorials-addteamff.html">Extend TEAMFF by Adding New Force Fields</a></li>
<li><a href="../offline/tutorials-useqmdff.html">Use QMDFF for Specific Force Fields</a></li>
</ul>
<p>IV References of Commands</p>
<ul>
<li><a href="../WinCommands/ProjectNav.html">Project Navigator</a></li>
<li><a href="../WinCommands/Toolbar.html">Toolbar</a></li>
<li><a href="../WinCommands/Mouse.html">Mouse Functions</a></li>
<li><a href="../WinCommands/File.html">File Menu</a></li>
<li><a href="../WinCommands/Edit.html">Edit Menu</a></li>
<li><a href="../WinCommands/Build.html">Build Menu</a></li>
<li><a href="../WinCommands/View.html">View Menu</a></li>
<li><a href="../WinCommands/TEAMFF.html">TEAMFF Menu</a></li>
<li><a href="../WinCommands/Simulation.html">Simulation Menu</a></li>
<li><a href="../WinCommands/QMDFF.html">QMDFF Menu</a></li>
<li><a href="../WinCommands/Forcefield.html">ForceField Menu</a></li>
<li><a href="../WinCommands/Parameter.html">Parameter Menu</a></li>
<li><a href="../WinCommands/QMD.html">QMD Menu</a></li>
<li><a href="../WinCommands/Help.html">Help Menu</a></li>
</ul>
<p>V. References of Executable Commands</p>
<ul>
<li><a href="../exe-commands/model-com.html">Model Commands</a></li>
<li><a href="../exe-commands/forcefield-com.html">ForceField Commands</a></li>
<li><a href="../exe-commands/export-com.html">Export Commands</a></li>
<li><a href="../exe-commands/database-com.html">TEAMFF Commands</a></li>
<li><a href="../exe-commands/fit-com.html">Fit Commands</a></li>
<li><a href="../exe-commands/mm-com.html">Molecular Mechanics Commands</a></li>
<li><a href="../exe-commands/qm-com.html">Quantum Mechanics Commands</a></li>
<li><a href="../exe-commands/qmdff-com.html">QMDFF commands</a></li>
</ul>
<p>IV. Concepts, Methods and Algorithms</p>
<ul>
<li>
<p><a href="introduction.html">Introduction</a></p>
</li>
<li>
<p><a href="forcefield-types.html">Force Field Types</a></p>
<ul>
<li><a href="forcefield-types.html">AMBER Type</a></li>
<li><a href="forcefield-types.html">TEAM Type</a></li>
</ul>
</li>
<li>
<p><a href="atom-types.html">Atom Types</a></p>
<ul>
<li><a href="atom-types-properties.html">Molecular and Atomic Properties</a></li>
<li><a href="atom-types-typingrules.html">Typing Rules</a></li>
<li><a href="atom-types-extensible.html">Extensible Definitions</a></li>
<li><a href="atom-types-hypervalence.html">Hyper-valence</a></li>
<li><a href="atom-types-equivalence.html">Equivalent Types</a></li>
<li><a href="atom-types-integrated.html">Integrated Types</a></li>
</ul>
</li>
<li>
<p><a href="parametrization.html">Parametrization</a></p>
<ul>
<li><a href="parametrization-trainingset.html">Training Set</a></li>
<li><a href="parametrization-general.html">General Procedure</a></li>
<li><a href="parametrization-autoPar.html">Automatic Parameters</a></li>
<li><a href="parametrization-qmd.html">Quantum Mechanics Data </a></li>
<li><a href="parametrization-fitqmd.html">Fit Quantum Mechanics Data </a></li>
<li><a href="parametrization-fitdimer.html">Fit Molecular Dimer</a></li>
<li><a href="parametrization-fitliquid.html">Fit Liquid Data</a></li>
</ul>
</li>
<li>
<p><a href="teamff-database.html">TEAMFF Database</a></p>
<ul>
<li><a href="teamff-forcefields.html">Included Force Fields</a></li>
<li><a href="teamff-extensibility.html">Extensibility of TEAMFF</a></li>
</ul>
</li>
<li>
<p><a href="qmdff-database.html">QMDFF Database</a></p>
</li>
<li>
<p><a href="molecular-simulations.html">Molecular Simulations</a></p>
</li>
</ul>
<p>WebDFF</p>
<ul>
<li><a href="../online/registration.html">Registration</a></li>
<li><a href="../online/tutorial.html">Tutorial</a></li>
<li><a href="../online/support.html">Support</a></li>
</ul>
<p>Appendix</p>
<ul>
<li><a href="../appendix/functions.html">Force Field Functions</a></li>
<li><a href="../exe-commands/firl-formats.html">File Formats</a></li>
</ul>
<p>Temporary Examples</p>
<ul>
<li><a href="../ch00/01-basic-syntax.html">Basic syntax</a></li>
<li><a href="../ch00/02-footnote.html">Footnote</a></li>
<li><a href="../ch00/03-table.html">Table</a></li>
<li><a href="../ch00/04-math-expression.html">Math expression</a></li>
</ul></nav>
    </aside>
    <main id="main"><article><p>Fit Liquid Data</p>
<p>DFF can be used to optimize VDW parameters automatically. This is done by combining a molecular dynamics simulation with a least-squares fit procedure.
Perturbation Theory
The statistic mechanical perturbation theory is used to enable the automation.36,38,50 Assume a small change to the adjustable parameters:<br>
a'_k=a_k+δa_k                              						(1)
The resultant change to the potential energy can be regarded as a perturbation:
U=U_o+δU                                                                      			(2)
Based on the perturbation theory, the configuration integral of canonical ensemble consisting of N particles can be written as:
Z_N=∫▒〖⋯∫▒〖exp⁡[-β(U_o+δU)] dq_1⋯dq_N 〗〗
■(&#x26;)=Z_N^o ⟨exp⁡[-β⋅δU] ⟩_o					(3)
where the brackets indicate unperturbed (reference state) ensemble average. For any physical property A, we have:
⟨A⟩=⟨A⟩_o+⟨δA⟩<em>o								(4)
For example, the internal energy and pressure of ensemble average are given by:
⟨E⟩=KT^2 ((∂ ln⁡〖Z_N 〗)/∂T)</em>(N,V)=⟨E⟩_o+⟨δU⟩<em>o					(5)
⟨P⟩=KT((∂ ln⁡〖Z_N 〗)/∂V)</em>(N,T)=⟨P⟩_o+⟨∑▒〖q_i  ∂δU/(∂q_i )〗⟩_o				(6)
The above equations indicate that the change in potential energy and pressure with the perturbation can be estimated by averaging the perturbation energy and virial in the reference state obtained by NVT simulation. The derivatives of an ensemble averaged property  (energy or pressure) with respect to the parameter ak is then:
∂⟨A⟩/(∂a_k )=⟨∂A/(∂a_k )⟩_o  								(7)
If the quantity ∂A/∂a_k can be analytically evaluated, such as the pressure and internal energy in canonic ensemble, the derivative can be obtained in one simulation. Subsequently, the parameters can be optimized by the least-square method automatically. Notice that in the fluctuation framework51, similar requirement is needed.
In order to obtain transferable parameters, several molecules containing the same atom types should be parameterized simultaneously. For example, the following table shows molecular liquids that can be used to parameterize non-valence parameters for alkanes:
Model	T	HOV	Den
cyclohexane	293.2 	8.0	0.779
2_2_4_trimethylpentane	303.2 	8.4	0.684
isopentane	293.2 	6.0	0.620
ethane	184.5 	3.5	0.546
propane	231.1 	4.5	0.581
2_2_dimethylhexane	303.2 	8.9	0.687
2_5_dimethylhexane	303.2 	8.9	0.685
pentane	293.2 	6.4	0.626
2_methylheptane	303.2 	9.5	0.690
butane	298.2 	5.3	0.573
octane	298.2 	10.2	0.699
methane	111.1 	2.0	0.424
The table lists temperature, heat of vaporization and equilibrium density of the relevant molecular liquids.
The uncertainty in ensemble average has a direct impact to the fitting quality. Large uncertainties associated with short simulation time lead to oscillation in the fitting parameters. In such situations, extending the simulation time is necessary.
For polar molecules with relatively large atomic partial charges, the electrostatic terms dominate the nonbond interactions. If the VDW parameters cannot be optimized to fit empirical data, the atomic charges may not be appropriate, even if the charges are derived by fitting QM electrostatic potentials. The reason is that the separation of electrostatic and VDW parameters is for convenience but not scientifically solid. As in principle, all intermolecular interactions are electrostatic in nature. Comparing the charge values with those in successful forcefields might be helpful. If necessary, consider using restraints in the ESP fit and re-parameterizing the charge parameters.
Similarly, if the valence parameters are incorrect, it could be very difficult to optimize the VDW parameters. Even if a fit seems to be successful, the VDW parameters might not be physically meaningful. Careful examination of the intramolecular properties such as bond lengths, angles and dihedral angles is a key to solve this problem.
Temperature Dependent Parameters
Strictly speaking, forcefield is not potential energy function because of the empirical (non-polarizable) functions deployed. The nonbond interaction is found to be dependent on temperature because of the polarization effects.35 One solution is to scale the dispersion coefficient C_6 using the following form of Lennard-Jones (LJ-12-6) function
V(r)=A/r^12 -(C_6^<em>)/r^6 									(8)
C_6^</em>=f_disp (T)  C_6								(9)
where the scaling factor f_disp (T)  is temperature dependent, which can be written as a linear function,
f_disp (T)=1+λ(T-T_ref ).							(10)
The reference temperature T_ref is conveniently fixed at 298 K.
Using the expression of Lennard-Jones (LJ-12-6) function used in DFF,  the well-depth and radius parameters are expressed as:
ε_ij (T)=f_disp^2 (T) ε_ij (298)							(11)
r_ij^o (T)=f_disp^(-1/6) (T) r_ij^o (298)							(12)
It is found that the scaling factor is rather generic, it takes only two values depending on the hybridization state of the atom type:
Atom type	λ (/K)	Description
c_3a	5.0E-05	C, aromatic
c_3ac	5.0E-05	C, aromatic, bond to C
c_3aco	5.0E-05	C, aromatic, with carbonyl
c_3o	5.0E-05	C, sp2, in ketone
c_3oh	5.0E-05	C, sp2, in aldehyde
c_3oh2	5.0E-05	C, sp2, in formaldehyde
c_4	1.4E-04	C, sp3
c_4h	1.4E-04	C, sp3, with 1 H
c_4h2	1.4E-04	C, sp3, with 2 H
c_4h3	1.4E-04	C, sp3, with 3 H
c_4o2	1.4E-04	C, sp3, bond to 2 O
c_4oh2	1.4E-04	C, sp3, bond to O, with 2 H
c_4oh3	1.4E-04	C, sp3, bond to O, with 3 H
h_1	1.4E-04	H
o_1	5.0E-05	O, sp2, in carbonyl
o_2	1.4E-04	O, sp3, in ether
The scaling factors are specified by a global parameter file: /data TemperatureFactor.dat, which subject to further optimizations.</p></article></main>
    <script type="module">"use strict";console.log("ui ready");[...document.querySelectorAll("nav a")].find(a=>a.pathname===location.pathname)?.classList.add("active");
</script>
  </body>
</html>
