<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DFF</title>
    <style>*,*:before,*:after{box-sizing:border-box}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;color:#333}nav a:where(.active){background:#333;color:#fff}img{display:block;max-width:100%}code{font-weight:600}pre{background:#444;color:#fff;padding:1ch}pre code{background-color:inherit}table{border-collapse:collapse}table :where(th,td){border:1px solid #666}:where(h2,h3,h4) a{color:inherit;text-decoration:none}:where(h2,h3,h4) a:hover{text-decoration:underline}:where(h2,h3,h4) a:hover:after{content:" #"}.c-app-layout{display:grid;margin:0 auto;grid-template-columns:auto 1fr;gap:32px}.c-app-menu{top:0;position:sticky;overflow-y:scroll;padding:0 32px;background-color:#eee;height:100vh}
</style>
  </head>
  <body class="c-app-layout">
    <aside class="c-app-menu">
      <nav class="u-reset"><p>User Guide DFF 8.0</p>
<ul>
<li><a href="../index.html">Introduction</a></li>
</ul>
<p>Online Use</p>
<ul>
<li><a href="../online/registration.html">Registration</a></li>
<li><a href="../online/tutorial.html">Tutorial</a></li>
<li><a href="../online/support.html">Support</a></li>
</ul>
<p>Offline Use</p>
<ul>
<li><a href="../offline/get-started.html">Get Started</a></li>
<li><a href="../offline/tutorialA.html">Tutorials A - Essential Functionality</a>
<ul>
<li><a href="../offline/tutorialsA-builder.html">Tutorial A1 - Building a Model of Molecule</a></li>
<li><a href="../offline/tutorialsA-liquid.html">Tutorial A2 - Working With a Liquid Model</a></li>
<li><a href="../offline/tutorialsA-polymer.html">Tutorial A3 - Working with Polymers</a></li>
<li><a href="../offline/tutorialsA-protein.html">Tutorial A4 - Working with Proteins</a></li>
<li><a href="../offline/tutorialsA-mixforcefields.html">Tutorial A5 - Mixing Force fields</a></li>
</ul>
</li>
<li><a href="../offline/tutorialB.html">Tutorials B - Parameterization Methods</a>
<ul>
<li><a href="../offline/tutorialsB-qmdata.html">Tutorial B1 - Prepare QM Data</a></li>
<li><a href="../offline/tutorialsB-fitmolecule.html">Tutorial B2 - Fit QM Data of Molecule</a></li>
<li><a href="../offline/tutorialsB-fitdimer.html">Tutorial B3 - Fit QM Data of Molecular Dimer</a></li>
<li><a href="../offline/tutorialsB-fitliquid.html">Tutorial B4 - Fit Liquid Data</a></li>
</ul>
</li>
<li><a href="../offline/tutorialC.html">Tutorials C - Database Methods</a>
<ul>
<li><a href="../offline/tutorialsB-qmdata.html">Tutorial C1 - Augment TEAMFF</a></li>
<li><a href="../offline/tutorialsB-qmdata.html">Tutorial C2 - Use QMDFF</a></li>
</ul>
</li>
</ul>
<p>Concepts, Methods and Algorithms</p>
<ul>
<li>
<p><a href="forcefield-types.html">Force Field Types</a></p>
<ul>
<li><a href="forcefield-types.html">AMBER Type</a></li>
<li><a href="forcefield-types.html">TEAM Type</a></li>
</ul>
</li>
<li>
<p><a href="atom-types.html">Atom Types</a></p>
<ul>
<li><a href="atom-types-properties.html">Molecular and Atomic Properties</a></li>
<li><a href="atom-types-typingrules.html">Typing Rules</a></li>
<li><a href="atom-types-extensible.html">Extensible Definitions</a></li>
<li><a href="atom-types-hypervalence.html">Hyper-valence</a></li>
<li><a href="atom-types-equivalence.html">Equivalent Types</a></li>
<li><a href="atom-types-integrated.html">Integrated Types</a></li>
</ul>
</li>
<li>
<p><a href="parametrization.html">Parametrization</a></p>
<ul>
<li><a href="parametrization-trainingset.html">Training Set</a></li>
<li><a href="parametrization-general.html">General Procedure</a></li>
<li><a href="parametrization-autoPar.html">Automatic Parameters</a></li>
<li><a href="parametrization-qmd.html">Quantum Mechanics Data </a></li>
<li><a href="parametrization-fitqmd.html">Fit Quantum Mechanics Data </a></li>
<li><a href="parametrization-fitdimer.html">Fit Molecular Dimer</a></li>
<li><a href="parametrization-fitliquid.html">Fit Liquid Data</a></li>
</ul>
</li>
<li>
<p><a href="teamff-database.html">TEAMFF Database</a></p>
<ul>
<li><a href="teamff-forcefields.html">Included Force Fields</a></li>
<li><a href="teamff-extensibility.html">Extensibility of TEAMFF</a></li>
</ul>
</li>
<li>
<p><a href="qmdff-database.html">QMDFF Database</a></p>
</li>
<li>
<p><a href="molecular-simulations.html">Molecular Simulations</a></p>
</li>
</ul>
<p>References of GUI Commands</p>
<ul>
<li><a href="../gui-commands/overview.html">Manage Projects</a>
<ul>
<li><a href="../gui-commands/project-tree.html">Project Tree</a></li>
<li><a href="../gui-commands/toolbar-commnads.html">Toolbar Commands</a></li>
<li><a href="../gui-commands/mouse-function.html">Mouse Functions</a></li>
</ul>
</li>
<li><a href="../gui-commands/file-menu.html">File Menu</a></li>
<li><a href="../gui-commands/build-menu.html">Build Menu</a></li>
<li><a href="../gui-commands/view-menu.html">View Menu</a></li>
<li><a href="../gui-commands/teamff-menu.html">TEAMFF Menu</a></li>
<li><a href="../gui-commands/simulation-menu.html">Simulation Menu</a></li>
<li><a href="../gui-commands/qmdff-menu.html">QMDFF Menu</a></li>
<li><a href="../gui-commands/qmdff-menu.html">Force Field Menu</a></li>
<li><a href="../gui-commands/parameter-menu.html">Parameter Menu</a></li>
<li><a href="../gui-commands/qmd-menu.html">QMD Menu</a></li>
<li><a href="../gui-commands/help-menu.html">Help Menu</a></li>
</ul>
<p>References of Executable Commands</p>
<ul>
<li><a href="../exe-commands/model-com.html">Model Commands</a></li>
<li><a href="../exe-commands/forcefield-com.html">ForceField Commands</a></li>
<li><a href="../exe-commands/export-com.html">Export Commands</a></li>
<li><a href="../exe-commands/database-com.html">TEAMFF Commands</a></li>
<li><a href="../exe-commands/fit-com.html">Fit Commands</a></li>
<li><a href="../exe-commands/mm-com.html">Molecular Mechanics Commands</a></li>
<li><a href="../exe-commands/qm-com.html">Quantum Mechanics Commands</a></li>
<li><a href="../exe-commands/qmdff-com.html">QMDFF commands</a></li>
</ul>
<p>Appendix</p>
<ul>
<li><a href="../appendix/functions.html">Force Field Functions</a></li>
<li><a href="../exe-commands/firl-formats.html">File Formats</a></li>
</ul>
<p>Temporary Examples</p>
<ul>
<li><a href="../ch00/01-basic-syntax.html">Basic syntax</a></li>
<li><a href="../ch00/02-footnote.html">Footnote</a></li>
<li><a href="../ch00/03-table.html">Table</a></li>
<li><a href="../ch00/04-math-expression.html">Math expression</a></li>
</ul></nav>
    </aside>
    <main id="main"><article><p>Typing Rule</p>
<h3 id="atom-type-definitions"><a href="#atom-type-definitions">Atom Type Definitions</a></h3>
<p>In DFF, atom types are assigned using typing rules. Three types of typing rules are implemented: Default, Extended Default and Scripted.</p>
<h4 id="default"><a href="#default">Default</a></h4>
<p>A default definition starts with a three-character root type in which the first two characters are reserved for a given atom's element symbol. If the element symbol is a single character, it is followed by an underscore. The third character is an integer that corresponds to the coordination number or the number of chemical bonds connected to the given atom. For example, n_3 represents a nitrogen atom with three chemical bonds.</p>
<p>From the root type, a binary tree data structure is used to classify atom types in three levels:</p>
<ol>
<li>
<p>Small ring size. If an atom is in a small ring (&#x3C;6), the ring size is assigned. Therefore, an integer at the fourth character is a flag indicating the atom is in a small ring (e.g., n_35).</p>
</li>
<li>
<p>Formal Charge. If a formal charge is assigned to an atom, it is flagged by a sign (+ or –) followed by an integer (1 is omitted) or a character representing a fractional formal charge:</p>
</li>
</ol>
<p><code>d:Double(1/2)</code>
<code>t:Triple(1/3)</code>
<code>q:Quadruple(1/4)</code>
<code>p:Pentuple(1/5)</code>
<code>h:Hextuple (1/6)</code></p>
<ol start="3">
<li>Aromaticity. If an atom is in an aromatic ring, the reserved character “a” is appended.</li>
</ol>
<p>For example, the atom type <code>c_35+pa</code> represents a carbon atom with three bonds in a five-member aromatic ring bearing a +1/5 formal charge.</p>
<p>The default definition provides the most essential information for an atom and has the following properties:</p>
<ol>
<li>the definition is complete; that is, any atom in any environment has an assigned atom type;</li>
<li>each atom type is uniquely defined because only two child nodes are present at each node of the tree, and the choices are mutually exclusive; and</li>
<li>the atom types are defined inheritably, that is, each atom subtype has only one parent atom type, and each atom subtype represents a subset of the chemical space represented by the parent atom type.</li>
</ol>
<h4 id="extended-default"><a href="#extended-default">Extended Default</a></h4>
<p>In order to improve the level of description accuracy, Extended Default definition is implemented by adding more specific definitions using scripts. This forms the hierarchical atom type (HAT) scheme. [^1]</p>
<p>The extended definition starts from the Default definition. The attributes of neighboring atoms are then collected, and the search for neighbors can be nested. A multi-node tree data structure is used for extended definitions because the number of attributes is sufficiently large to differentiate atom types at a given level. An extended definition is specified by a set of scripts, which can be prepared using a text editor. For example, the following script defines a given amide nitrogen with two hydrogen atoms as n_3mh2, which is extended from the default atom type n_3:</p>
<p><code>Define n_3m2h</code> 
<code>N[–*] [–H] [–C[=O]]</code> 
<code>atom 1: co=3, ar=no, rs>5, fc=0</code> 
<code>atom 2: co=?, elem = C, Si</code> 
<code>atom 3: co=?</code> 
<code>atom 4: co=3</code> 
<code>atom 5: co=1</code> 
<code>End</code> </p>
<p>In this example, the first line is the atom type. The second line defines the topological substructure of the atom type to be defined. The substructure is defined using element symbols and bond orders. Element symbols can be a wild card symbol (* or ?). Bond orders are defined as single, double, partial double, triple and/or any bond order. In this example, the atom element (N) maps out the connectivity for the amide nitrogen atom, which has three single bonds: [–*], [–H], and [–C[=O]]. Brackets indicate substructures that can be nested. From lines 3 to 7, attributes for each atom in line 2 are provided in order of appearance. The coordination number (co) must be listed, but “?” indicates that the coordination number is ignored. Other characters include aromaticity (ar), ring size (rs), and formal charge (fc).</p>
<p>The same exclusive and inheritable properties of default definitions are implemented for extended definitions. Each child node has only one parent node, and sibling nodes are exclusively defined. The software tests the following two conditions to enforce exclusive and inheritable properties:</p>
<ul>
<li>each atom type must represent a subset of the chemical space that its parent atom type represents, and</li>
<li>the chemical spaces represented by sibling atom types must not overlap.</li>
</ul>
<p>Extended definitions are prepared as a definition file named &#x3C;filename>.ext. For each extended definition for an atom type, a block of scripts as in the above example should be included. A complete description of the definition file format (.ext) is given in Chapter 6 of this document. This file must be placed in the &#x3C;dff-root>/data folder.</p>
<h4 id="scripted"><a href="#scripted">Scripted</a></h4>
<p>Scripts can be used to prepare a set of definitions without extending the default definitions. This definition is completely flexible, it does not rely on any predefined rules, can be defined at any level of sophistication. The definition is written as scripts that uses molecular topological information and atomic properties. The definition is particularly useful when importing a force field. The extension name for a Free Definition file is *.def.</p></article></main>
    <script type="module">"use strict";console.log("ui ready");[...document.querySelectorAll("nav a")].find(a=>a.pathname===location.pathname)?.classList.add("active");
</script>
  </body>
</html>
